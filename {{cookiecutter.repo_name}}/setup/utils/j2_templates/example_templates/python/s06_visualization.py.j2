from s02_utils import load_pickle, ensure_dir_exists
from sklearn.decomposition import PCA
import matplotlib.pyplot as plt
import os

base_path = os.path.abspath(os.path.join(os.path.dirname(__file__), ".."))
interim_data = os.path.join(base_path, "data", "01_interim")
processed_data = os.path.join(base_path, "data", "02_processed")
figures_path = os.path.join(base_path, "results", "figures")
ensure_dir_exists(figures_path)

def visualize():
    data = load_pickle(os.path.join(interim_data, "iris_interim.pkl"))
    model = load_pickle(os.path.join(processed_data, "iris_model.pkl"))
    X_pca = PCA(n_components=2).fit_transform(data['X'])
    y = data['y']
    plt.figure()
    scatter = plt.scatter(X_pca[:, 0], X_pca[:, 1], c=y, cmap='viridis')
    plt.legend(*scatter.legend_elements(), title="Classes")
    plt.title("Iris dataset PCA Projection")
    plt.savefig(os.path.join(figures_path, "iris_pca_projection.png"))
    plt.close()

def main():
    print("Visualizing Iris data...")
    visualize()

if __name__ == "__main__":
    main()
